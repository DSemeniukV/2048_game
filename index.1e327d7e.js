!function(){function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function t(t,r){if(t){if("string"==typeof t)return e(t,r);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e(t,r)}}function r(r){return function(t){if(Array.isArray(t))return e(t)}(r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||t(r)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var n=new/*#__PURE__*/(function(){var e;function n(e){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,n),this.size=4,this.score=0,this.gameStatus="idle",this.board=e||this.createEmptyBoard()}return e=[{key:"createEmptyBoard",value:function(){var e=this;return Array.from({length:this.size},function(){return Array(e.size).fill(0)})}},{key:"moveLeft",value:function(){this.handleMove(this.board,!1)&&(this.addRandomTile(),this.checkGameOver())}},{key:"moveRight",value:function(){this.handleMove(this.board,!0)&&(this.addRandomTile(),this.checkGameOver())}},{key:"moveUp",value:function(){var e=this.transpose(this.board);this.handleMove(e,!1)&&(this.board=this.transpose(e),this.addRandomTile(),this.checkGameOver())}},{key:"moveDown",value:function(){var e=this.transpose(this.board);this.handleMove(e,!0)&&(this.board=this.transpose(e),this.addRandomTile(),this.checkGameOver())}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.board}},{key:"getStatus",value:function(){return this.gameStatus}},{key:"start",value:function(){"idle"===this.gameStatus&&(this.gameStatus="playing",this.board=this.createEmptyBoard(),this.addRandomTile(),this.addRandomTile())}},{key:"restart",value:function(){this.score=0,this.gameStatus="idle",this.start()}},{key:"handleMove",value:function(e,t){for(var n=this,a=!1,o=0;o<this.size;o++)!function(o){var i=r(e[o]);t&&i.reverse();for(var s=i.filter(function(e){return 0!==e}),u=0;u<s.length-1;u++)s[u]===s[u+1]&&(s[u]*=2,n.score+=s[u],s[u+1]=0,2048===s[u]&&(n.gameStatus="win"));var l=s.filter(function(e){return 0!==e}),c=r(l).concat(r(Array(n.size-l.length).fill(0)));t&&c.reverse(),n.arraysEqual(c,e[o])||(e[o]=c,a=!0)}(o);return a}},{key:"transpose",value:function(e){return e[0].map(function(t,r){return e.map(function(e){return e[r]})})}},{key:"arraysEqual",value:function(e,t){return e.every(function(e,r){return e===t[r]})}},{key:"addRandomTile",value:function(){for(var e=[],r=0;r<this.size;r++)for(var n=0;n<this.size;n++)0===this.board[r][n]&&e.push([r,n]);if(e.length){var a,o=function(e){if(Array.isArray(e))return e}(a=e[Math.floor(Math.random()*e.length)])||function(e,t){var r,n,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],i=!0,s=!1;try{for(a=a.call(e);!(i=(r=a.next()).done)&&(o.push(r.value),2!==o.length);i=!0);}catch(e){s=!0,n=e}finally{try{i||null==a.return||a.return()}finally{if(s)throw n}}return o}}(a,2)||t(a,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),i=o[0],s=o[1];this.board[i][s]=.9>Math.random()?2:4}}},{key:"checkGameOver",value:function(){var e=this;!(this.board.some(function(e){return e.includes(2048)})||this.board.some(function(e){return e.includes(0)}))&&([this.moveLeftPreview,this.moveRightPreview,this.moveUpPreview,this.moveDownPreview].some(function(t){return t.call(e)})||(this.gameStatus="lose"))}},{key:"moveLeftPreview",value:function(){return this.board.some(function(e){for(var t=0;t<e.length-1;t++)if(e[t]===e[t+1])return!0;return!1})}},{key:"moveRightPreview",value:function(){return this.moveLeftPreview()}},{key:"moveUpPreview",value:function(){return this.transpose(this.board).some(function(e){for(var t=0;t<e.length-1;t++)if(e[t]===e[t+1])return!0;return!1})}},{key:"moveDownPreview",value:function(){return this.moveUpPreview()}}],function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(n.prototype,e),n}()),a=document.querySelectorAll(".field-cell"),o=document.querySelector(".game-score"),i=document.querySelector(".button"),s=document.querySelector(".message-start"),u=document.querySelector(".message-win"),l=document.querySelector(".message-lose");function c(){var e,t=n.getState().flat();a.forEach(function(e,r){var n=t[r];e.textContent=0===n?"":n,e.className="field-cell",n&&e.classList.add("field-cell--".concat(n))}),o.textContent=n.getScore(),e=n.getStatus(),s.classList.toggle("hidden","idle"!==e),u.classList.toggle("hidden","win"!==e),l.classList.toggle("hidden","lose"!==e),"playing"===e?(i.classList.replace("start","restart"),i.textContent="Restart"):(i.classList.replace("restart","start"),i.textContent="Start")}i.addEventListener("click",function(){"idle"===n.getStatus()?n.start():n.restart(),c()}),document.addEventListener("keydown",function(e){switch(e.key){case"ArrowLeft":n.moveLeft();break;case"ArrowRight":n.moveRight();break;case"ArrowUp":n.moveUp();break;case"ArrowDown":n.moveDown();break;default:return}c()}),c()}();
//# sourceMappingURL=index.1e327d7e.js.map
